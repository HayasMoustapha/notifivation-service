# ğŸ“§ Event Planner - Notification Service Environment Configuration
#
# ğŸ“‹ GUIDE D'UTILISATION :
# 1. Copier ce fichier en .env.local pour le dÃ©veloppement
# 2. Copier ce fichier en .env pour la production
# 3. Remplacer les valeurs par dÃ©faut par vos vraies clÃ©s
# 4. NE JAMAIS COMMITTER le fichier .env contenant des secrets !

# ===========================================
# ğŸš€ SERVEUR & ENVIRONNEMENT
# ===========================================
PORT=3002
# ğŸ¯ Port d'Ã©coute du service (doit Ãªtre unique par service)
NODE_ENV=development
# ğŸŒ Environnement : development | staging | production

# ===========================================
# ğŸ—„ï¸ BASE DE DONNÃ‰ES POSTGRESQL
# ===========================================
DB_HOST=localhost
# ğŸ  HÃ´te de la base de donnÃ©es (localhost en dev, RDS endpoint en prod)
DB_PORT=5432
# ğŸšª Port PostgreSQL (5432 par dÃ©faut)
DB_NAME=event_planner_notifications
# ğŸ“Š Nom de la base de donnÃ©es (prÃ©fixe event_planner_ recommandÃ©)
DB_USER=postgres
# ğŸ‘¤ Utilisateur PostgreSQL (crÃ©er un utilisateur dÃ©diÃ© en prod)
DB_PASSWORD=postgres
# ğŸ” Mot de passe PostgreSQL (utiliser un mot de passe fort en prod)
DB_SSL=false
# ğŸ”’ Connexion SSL (true en production avec RDS)

# Pool de connexions pour optimiser les performances
DB_POOL_MIN=2
# ğŸ”¢ Nombre minimum de connexions dans le pool
DB_POOL_MAX=10
# ğŸ”¢ Nombre maximum de connexions dans le pool
DB_POOL_IDLE_TIMEOUT=30000
# â° Timeout d'inactivitÃ© des connexions (ms)

# Bootstrap automatique de la base de donnÃ©es
# âš ï¸  DÃ‰SACTIVÃ‰ PAR DÃ‰FAUT EN PRODUCTION POUR SÃ‰CURITÃ‰
# âœ… true : CrÃ©e automatiquement les tables et index au dÃ©marrage
# âŒ false : NÃ©cessite une migration manuelle en production
DB_AUTO_BOOTSTRAP=false

# ===========================================
# ğŸŒ FRONTEND CONFIGURATION
# ===========================================
FRONTEND_URL=http://localhost:3000
# ğŸ  URL du frontend pour les liens dans les emails
# En production: https://votredomaine.com
# En staging: https://staging.votredomaine.com

# ===========================================
# ğŸ” AUTHENTIFICATION UNIFIÃ‰E
# ===========================================
# âš ï¸ IMPORTANT: Utiliser le mÃªme secret que l'auth service
# ğŸ”‘ GÃ©nÃ©rer une clÃ© sÃ©curisÃ©e : openssl rand -base64 32
JWT_SECRET=your_super_secure_256_bit_secret_key_change_in_production
# ğŸ” ClÃ© secrÃ¨te pour vÃ©rifier les tokens JWT (doit Ãªtre identique Ã  l'Auth Service)

# Configuration JWT avancÃ©e
JWT_ALGORITHM=HS256
# ğŸ› ï¸ Algorithme de signature (doit Ãªtre identique Ã  l'Auth Service)
JWT_ISSUER=auth-service
# ğŸ¢ Ã‰metteur attendu des tokens JWT (doit Ãªtre identique Ã  l'Auth Service)
JWT_AUDIENCE=event-planner
# ğŸ‘¥ Audience du token (doit Ãªtre identique Ã  l'Auth Service)

# Configuration validation JWT
JWT_VERIFY_ISSUER=true
# âœ… VÃ©rifier l'Ã©metteur du token (sÃ©curitÃ©)
JWT_VERIFY_AUDIENCE=true
# âœ… VÃ©rifier l'audience du token (sÃ©curitÃ©)
JWT_VERIFY_EXPIRATION=true
# âœ… VÃ©rifier l'expiration du token (sÃ©curitÃ©)
JWT_MAX_AGE=7d
# ğŸ“… Ã‚ge maximum du token acceptÃ©
JWT_CLOCK_TOLERANCE=0
# â° TolÃ©rance de temps (pour les dÃ©calages d'horloge)

# ===========================================
# ğŸŒ INTER-SERVICES COMMUNICATION
# ===========================================
# Token partagÃ© pour communication entre services
# ğŸ”‘ GÃ©nÃ©rer : openssl rand -base64 32 (doit Ãªtre identique partout)
SHARED_SERVICE_TOKEN=shared-service-token-abcdef12345678901234567890
# ğŸ” Token pour authentifier les communications inter-services

# URLs des autres services (pour health checks et communication)
AUTH_SERVICE_URL=http://localhost:3000
# ğŸ” URL du service d'authentification
CORE_SERVICE_URL=http://localhost:3001
# ğŸ¯ URL du service principal
PAYMENT_SERVICE_URL=http://localhost:3003
# ğŸ’³ URL du service de paiements
TICKET_GENERATOR_SERVICE_URL=http://localhost:3004
# ğŸ« URL du service de gÃ©nÃ©ration de tickets
SCAN_VALIDATION_SERVICE_URL=http://localhost:3005
# ğŸ” URL du service de validation

# Timeout pour les appels HTTP inter-services
INTER_SERVICE_TIMEOUT=30000
# â° Timeout par dÃ©faut (30000ms = 30 secondes)
INTER_SERVICE_RETRY_ATTEMPTS=3
# ğŸ”¢ Nombre de tentatives de retry
INTER_SERVICE_RETRY_DELAY=1000
# â° DÃ©lai entre les retries (1000ms = 1 seconde)

# ===========================================
# ğŸ’¾ CACHE REDIS
# ===========================================
REDIS_HOST=localhost
# ğŸ  HÃ´te Redis (localhost en dev, ElastiCache endpoint en prod)
REDIS_PORT=6379
# ğŸšª Port Redis (6379 par dÃ©faut)
REDIS_PASSWORD=your_redis_password
# ğŸ” Mot de passe Redis (recommandÃ© en production)
REDIS_DB=2
# ğŸ“Š NumÃ©ro de la base Redis (2 pour Notification Service)

# Configuration du cache
CACHE_TTL=3600
# â° DurÃ©e de vie du cache en secondes (3600 = 1 heure)
CACHE_MAX_KEYS=10000
# ğŸ”¢ Nombre maximum de clÃ©s en cache

# ===========================================
# ğŸ“‹ FILES D'ATTENTE REDIS (Bull Queue)
# ===========================================
REDIS_QUEUE_HOST=localhost
# ğŸ  HÃ´te Redis pour les queues (peut Ãªtre le mÃªme que le cache)
REDIS_QUEUE_PORT=6379
# ğŸšª Port Redis pour les queues
REDIS_QUEUE_PASSWORD=your_redis_password
# ğŸ” Mot de passe Redis pour les queues
REDIS_QUEUE_DB=2
# ğŸ“Š NumÃ©ro de la base Redis pour les queues (mÃªme DB que cache)

# Configuration des queues
QUEUE_DEFAULT_JOB_OPTIONS_RETRY_ATTEMPTS=3
# ğŸ”¢ Nombre de tentatives de retry par dÃ©faut
QUEUE_DEFAULT_JOB_OPTIONS_BACKOFF=exponential
# ğŸ”„ StratÃ©gie de retry : fixed | exponential
QUEUE_CONCURRENCY=10
# ğŸ”¢ Nombre de notifications traitÃ©es en parallÃ¨le

# ===========================================
# ğŸ“§ EMAIL SERVICE (SENDGRID PRIMAIRE)
# ===========================================
SENDGRID_API_KEY=SG.your_sendgrid_api_key
# ğŸ”‘ ClÃ© API SendGrid (obtenir depuis sendgrid.com)
FROM_EMAIL=noreply@eventplanner.com
# ğŸ“§ Email d'expÃ©diteur (doit Ãªtre vÃ©rifiÃ© chez SendGrid)
FROM_NAME=Event Planner
# ğŸ“ Nom d'expÃ©diteur affichÃ©

# ===========================================
# ğŸ“§ SMTP (FALLBACK EMAIL)
# ===========================================
SMTP_HOST=smtp.gmail.com
# ğŸ“§ Serveur SMTP principal (fallback si SendGrid Ã©choue)
SMTP_PORT=587
# ğŸšª Port SMTP (587 pour TLS, 465 pour SSL)
SMTP_SECURE=false
# ğŸ”’ Connexion sÃ©curisÃ©e (false pour TLS, true pour SSL)
SMTP_USER=your_email@gmail.com
# ğŸ‘¤ Email SMTP (utiliser un email dÃ©diÃ© en prod)
SMTP_PASS=your_app_password
# ğŸ” Mot de passe SMTP (utiliser un mot d'application Gmail)

# ===========================================
# ğŸ“± SMS SERVICE (TWILIO PRIMAIRE)
# ===========================================
TWILIO_ACCOUNT_SID=your_twilio_account_sid
# ğŸ”‘ SID du compte Twilio (obtenir depuis console.twilio.com)
TWILIO_AUTH_TOKEN=your_twilio_auth_token
# ğŸ” Token d'authentification Twilio
TWILIO_PHONE_NUMBER=+1234567890
# ğŸ“± NumÃ©ro Twilio (format international avec +)

# ===========================================
# ğŸ“± VONAGE (FALLBACK SMS)
# ===========================================
VONAGE_API_KEY=your_vonage_api_key
# ğŸ”‘ ClÃ© API Vonage (backup si Twilio Ã©choue)
VONAGE_API_SECRET=your_vonage_api_secret
# ğŸ” Secret API Vonage
VONAGE_FROM_NUMBER=EventPlanner
# ğŸ“ Nom d'expÃ©diteur Vonage

# ===========================================
# ğŸ“§ EMAIL TEMPLATES
# ===========================================
EMAIL_TEMPLATES_PATH=./templates
# ï¿½ Chemin des templates d'emails
DEFAULT_EMAIL_LOCALE=fr
# ğŸŒ Langue par dÃ©faut pour les emails
ENABLE_EMAIL_TEMPLATES_CACHING=true
# ğŸ—„ï¸ Activer le cache des templates

# Types de templates supportÃ©s
SUPPORTED_EMAIL_TEMPLATES=event-created,guest-registered,payment-confirmed,event-reminder,ticket-generated
# ğŸ“§ Templates disponibles (sÃ©parer par des virgules)

# ===========================================
# ğŸ“± SMS TEMPLATES
# ===========================================
SMS_MAX_LENGTH=160
# ğŸ“ Longueur maximale d'un SMS (160 caractÃ¨res par dÃ©faut)
SMS_DEFAULT_LOCALE=fr
# ğŸŒ Langue par dÃ©faut pour les SMS
SMS_TRUNCATE_ENABLED=true
# âœ… Activer la troncation automatique des SMS trop longs

# ===========================================
# ï¿½ğŸ“ LOGGING
# ===========================================
LOG_LEVEL=info
# ğŸ“Š Niveau de log : error | warn | info | debug
LOG_FILE_PATH=logs
# ğŸ“ Chemin des fichiers de log
LOG_MAX_SIZE=20MB
# ğŸ“ Taille maximale d'un fichier de log
LOG_MAX_FILES=14d
# ğŸ“… DurÃ©e de rÃ©tention des logs (14 jours recommandÃ©)

# Activer les logs structurÃ©s
ENABLE_STRUCTURED_LOGS=true
# ğŸ“Š Activer les logs au format JSON
ENABLE_REQUEST_LOGGING=true
# ğŸ“ Activer les logs des requÃªtes HTTP
ENABLE_NOTIFICATION_LOGGING=true
# ğŸ“§ Activer les logs dÃ©taillÃ©s des notifications

# ===========================================
# ğŸ“Š MONITORING
# ===========================================
ENABLE_METRICS=true
# ğŸ“ˆ Activer les mÃ©triques Prometheus
METRICS_PORT=9092
# ğŸšª Port pour les mÃ©triques (doit Ãªtre unique)
ENABLE_HEALTH_CHECKS=true
# âœ… Activer les health checks dÃ©taillÃ©s
ENABLE_PERFORMANCE_MONITORING=true
# ğŸ“ˆ Activer le monitoring des performances

# ===========================================
# ğŸš¦ RATE LIMITING
# ===========================================
RATE_LIMIT_WINDOW_MS=900000
# â° FenÃªtre de temps pour le rate limiting (900000ms = 15 minutes)
RATE_LIMIT_MAX_REQUESTS=500
# ğŸ”¢ Nombre max de requÃªtes par fenÃªtre (global)
EMAIL_RATE_LIMIT_PER_HOUR=100
# ğŸ“§ Limite d'envoi d'emails par heure
SMS_RATE_LIMIT_PER_HOUR=50
# ğŸ“± Limite d'envoi de SMS par heure

# Rate limiting spÃ©cifique par endpoint
NOTIFICATION_SEND_RATE_LIMIT=200
# ğŸ“§ Limite pour l'endpoint d'envoi de notifications
TEMPLATE_PREVIEW_RATE_LIMIT=50
# ğŸ‘ï¸ Limite pour l'endpoint de preview de templates

# ===========================================
# ï¿½ WEBHOOKS
# ===========================================
ENABLE_WEBHOOKS=true
# âœ… Activer les webhooks pour les Ã©vÃ©nements de notification
WEBHOOK_TIMEOUT=10000
# â° Timeout pour les webhooks (10000ms = 10 secondes)
WEBHOOK_RETRY_ATTEMPTS=3
# ğŸ”¢ Nombre de tentatives de retry pour les webhooks
WEBHOOK_RETRY_DELAY=2000
# â° DÃ©lai entre les retries (2000ms = 2 secondes)
WEBHOOK_SECRET=your_webhook_secret
# ğŸ” Secret pour signer les webhooks

# ===========================================
# ï¿½ NOTIFICATION STATISTICS
# ===========================================
ENABLE_DETAILED_LOGGING=true
# ğŸ“Š Activer les logs dÃ©taillÃ©s pour les statistiques
STATISTICS_RETENTION_DAYS=30
# ğŸ“… DurÃ©e de rÃ©tention des statistiques (jours)
ENABLE_REAL_TIME_STATS=true
# ğŸ“ˆ Activer les statistiques en temps rÃ©el
ENABLE_DELIVERY_TRACKING=true
# ğŸ“¡ Activer le suivi de livraison des notifications

# ===========================================
# ï¿½ï¸ SÃ‰CURITÃ‰
# ===========================================
CORS_ORIGIN=http://localhost:3000,http://localhost:3001,http://localhost:3002
# ğŸŒ Origines autorisÃ©es pour CORS (sÃ©parer par des virgules)
ENABLE_IP_WHITELIST=false
# âœ… Activer le whitelist d'IPs
ALLOWED_IPS=127.0.0.1,::1
# ğŸŒ Adresses IP autorisÃ©es (sÃ©parer par des virgules)
ENABLE_REQUEST_VALIDATION=true
# âœ… Activer la validation stricte des requÃªtes

# ===========================================
# ğŸ§ª TESTS & DÃ‰VELOPPEMENT
# ===========================================
ENABLE_MOCK_SERVICES=false
# ğŸ§ª Activer les services mockÃ©s pour les tests
ENABLE_DEBUG_MODE=false
# ğŸ› Activer le mode debug (informations supplÃ©mentaires)
ENABLE_PERFORMANCE_PROFILING=false
# ğŸ“ˆ Activer le profiling des performances (uniquement en dev)

# Configuration de test
TEST_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/event_planner_notifications_test
# ğŸ§ª URL de la base de donnÃ©es de test
TEST_REDIS_URL=redis://localhost:6379/15
# ğŸ§ª URL Redis pour les tests
MOCK_EMAIL_DELIVERY=true
# ğŸ“§ Mock la livraison d'emails en test
MOCK_SMS_DELIVERY=true
# ğŸ“± Mock la livraison de SMS en test
